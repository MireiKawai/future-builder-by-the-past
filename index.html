<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>My Universe</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400&family=DM+Mono:wght@300;400;500&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #f9f7f4;
  --bg2: #f2ede6;
  --ink: #1c1a17;
  --muted: #8a8278;
  --faint: #e6e0d8;
  --accent: #b8935a;
  --accent2: #d4b896;
  --danger: #c0392b;
  --future: #5a8a72;
}
*{margin:0;padding:0;box-sizing:border-box}
html{scroll-behavior:smooth}
body{
  background:var(--bg);color:var(--ink);
  font-family:'DM Mono',monospace;font-weight:300;
  font-size:13px;line-height:1.85;
  min-height:100vh;
}

/* â”€â”€ SCROLLBAR â”€â”€ */
::-webkit-scrollbar{width:4px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--faint)}

/* â”€â”€ NAV â”€â”€ */
nav{
  position:fixed;top:0;left:0;right:0;z-index:100;
  display:flex;justify-content:space-between;align-items:center;
  padding:22px 56px;
  backdrop-filter:blur(12px);
  background:rgba(249,247,244,.88);
  border-bottom:1px solid transparent;
  transition:border-color .3s;
}
nav.scrolled{border-color:var(--faint)}
.nav-logo{
  font-family:'Cormorant Garamond',serif;
  font-size:19px;font-weight:300;letter-spacing:.06em;
  cursor:pointer;
}
.nav-logo span{font-style:italic;color:var(--accent)}
.nav-links{display:flex;gap:36px;align-items:center}
.nav-links a{
  text-decoration:none;color:var(--muted);
  font-size:10px;letter-spacing:.18em;text-transform:uppercase;
  transition:color .2s;
}
.nav-links a:hover{color:var(--ink)}
.nav-edit-toggle{
  font-size:10px;letter-spacing:.12em;text-transform:uppercase;
  color:var(--accent);background:none;border:1px solid var(--accent2);
  padding:5px 14px;cursor:pointer;transition:all .2s;
}
.nav-edit-toggle:hover{background:var(--accent);color:#fff;border-color:var(--accent)}
.nav-edit-toggle.active{background:var(--accent);color:#fff;border-color:var(--accent)}

/* â”€â”€ LAYOUT â”€â”€ */
.wrap{max-width:900px;margin:0 auto;padding:0 56px}

section{padding:88px 0;border-bottom:1px solid var(--faint)}
section:last-child{border-bottom:none}

/* â”€â”€ HERO â”€â”€ */
#hero{padding-top:172px;padding-bottom:108px;border-bottom:1px solid var(--faint)}
.hero-tag{
  font-size:10px;letter-spacing:.22em;text-transform:uppercase;
  color:var(--muted);margin-bottom:20px;
  opacity:0;animation:rise .7s .1s both;
}
.hero-name{
  font-family:'Cormorant Garamond',serif;
  font-size:clamp(58px,9vw,100px);
  font-weight:300;line-height:1;
  letter-spacing:-.02em;margin-bottom:12px;
  opacity:0;animation:rise .8s .2s both;
}
.hero-name em{font-style:italic;color:var(--accent)}
.hero-subtitle{
  font-size:13px;color:var(--muted);
  max-width:480px;line-height:2;margin-bottom:36px;
  opacity:0;animation:rise .8s .35s both;
}
.hero-meta{
  display:flex;flex-wrap:wrap;gap:10px;
  opacity:0;animation:rise .8s .5s both;
}
.chip{
  border:1px solid var(--faint);background:var(--bg2);
  padding:5px 14px;font-size:10px;letter-spacing:.08em;
  color:var(--muted);border-radius:0;
}

/* hero edit */
.hero-edit-overlay{
  position:absolute;inset:0;
  background:rgba(249,247,244,.9);
  display:none;align-items:center;justify-content:center;
  flex-direction:column;gap:12px;
}
#hero{position:relative}
.edit-mode #hero .hero-edit-overlay{display:flex}

/* â”€â”€ SECTION HEADING â”€â”€ */
.sh{
  font-size:10px;letter-spacing:.25em;text-transform:uppercase;
  color:var(--accent);margin-bottom:44px;
  display:flex;align-items:center;gap:18px;
}
.sh::after{content:'';flex:1;height:1px;background:var(--faint)}
.sh-right{flex-direction:row-reverse}
.sh-right::after{display:none}
.sh-right::before{content:'';flex:1;height:1px;background:var(--faint)}

/* â”€â”€ ADD BUTTON â”€â”€ */
.add-btn{
  display:none;align-items:center;gap:6px;
  font-family:'DM Mono',monospace;font-size:10px;
  letter-spacing:.12em;text-transform:uppercase;
  color:var(--muted);background:none;border:1px dashed var(--faint);
  padding:10px 20px;cursor:pointer;margin-top:24px;
  transition:all .2s;width:100%;justify-content:center;
}
.add-btn:hover{border-color:var(--accent);color:var(--accent)}
.edit-mode .add-btn{display:flex}

/* â”€â”€ CAREER TIMELINE â”€â”€ */
.timeline{display:flex;flex-direction:column}
.tl-item{
  display:grid;grid-template-columns:110px 1fr;
  gap:0 36px;padding:30px 0;
  border-bottom:1px solid var(--faint);
  position:relative;
}
.tl-item:last-child{border-bottom:none}
.tl-year{
  font-size:11px;letter-spacing:.06em;color:var(--muted);
  padding-top:3px;font-style:italic;
}
.tl-body{}
.tl-title{
  font-family:'Cormorant Garamond',serif;
  font-size:22px;font-weight:400;margin-bottom:3px;
}
.tl-org{color:var(--muted);font-size:11px;margin-bottom:8px;letter-spacing:.04em}
.tl-desc{color:var(--muted);font-size:12px;line-height:2}
.tl-item.future .tl-year{color:var(--future)}
.tl-item.future .tl-title{color:var(--future);font-style:italic}
.future-badge{
  display:inline-block;font-size:8px;letter-spacing:.15em;
  text-transform:uppercase;color:var(--future);
  border:1px solid var(--future);padding:2px 7px;
  margin-left:10px;vertical-align:middle;opacity:.7;
}
.item-actions{
  display:none;position:absolute;top:28px;right:0;
  gap:8px;
}
.edit-mode .item-actions{display:flex}
.ia-btn{
  font-size:10px;letter-spacing:.1em;color:var(--muted);
  background:none;border:1px solid var(--faint);
  padding:4px 10px;cursor:pointer;transition:all .2s;
}
.ia-btn:hover{border-color:var(--ink);color:var(--ink)}
.ia-btn.del:hover{border-color:var(--danger);color:var(--danger)}

/* â”€â”€ SKILLS â”€â”€ */
.skills-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:20px}
.skill-card{
  border:1px solid var(--faint);padding:24px;
  background:var(--bg2);position:relative;
}
.skill-cat{
  font-size:9px;letter-spacing:.22em;text-transform:uppercase;
  color:var(--accent);margin-bottom:14px;
}
.skill-items{color:var(--muted);font-size:12px;line-height:2.3}

/* â”€â”€ PROJECTS â”€â”€ */
.projects-list{display:flex;flex-direction:column}
.proj-item{
  display:grid;grid-template-columns:1fr auto;
  gap:24px;align-items:start;
  padding:30px 0;border-bottom:1px solid var(--faint);
  position:relative;
}
.proj-item:last-child{border-bottom:none}
.proj-title{
  font-family:'Cormorant Garamond',serif;
  font-size:22px;font-weight:400;margin-bottom:6px;
}
.proj-desc{color:var(--muted);font-size:12px;line-height:2;margin-bottom:10px}
.proj-tags{display:flex;flex-wrap:wrap;gap:6px}
.ptag{
  font-size:9px;letter-spacing:.1em;text-transform:uppercase;
  border:1px solid var(--faint);padding:3px 10px;color:var(--muted);
}
.proj-link{
  font-size:10px;letter-spacing:.1em;text-transform:uppercase;
  color:var(--muted);text-decoration:none;
  border-bottom:1px solid var(--faint);
  transition:all .2s;white-space:nowrap;padding-top:4px;
}
.proj-link:hover{color:var(--accent);border-color:var(--accent)}

/* â”€â”€ FUTURE â”€â”€ */
.future-list{display:flex;flex-direction:column}
.fut-item{
  display:grid;grid-template-columns:36px 1fr;
  gap:0 24px;padding:24px 0;
  border-bottom:1px solid var(--faint);position:relative;
}
.fut-item:last-child{border-bottom:none}
.fut-num{
  font-family:'Cormorant Garamond',serif;
  font-size:32px;color:var(--faint);line-height:1;
  margin-top:-2px;
}
.fut-title{font-size:13px;margin-bottom:4px;letter-spacing:.02em}
.fut-desc{color:var(--muted);font-size:12px;line-height:1.9}
.fut-horizon{
  display:inline-block;font-size:9px;letter-spacing:.15em;
  text-transform:uppercase;color:var(--future);
  margin-top:8px;
}

/* â”€â”€ BOOKS â”€â”€ */
.books-list{display:flex;flex-direction:column}
.book-item{
  display:grid;grid-template-columns:44px 1fr auto;
  gap:0 20px;padding:22px 0;
  border-bottom:1px solid var(--faint);align-items:start;
  position:relative;
}
.book-item:last-child{border-bottom:none}
.book-n{
  font-family:'Cormorant Garamond',serif;
  font-size:26px;color:var(--faint);line-height:1;padding-top:2px;
}
.book-title{
  font-family:'Cormorant Garamond',serif;
  font-size:19px;font-weight:400;margin-bottom:3px;
}
.book-author{color:var(--muted);font-size:11px;margin-bottom:6px}
.book-note{color:var(--muted);font-size:12px;line-height:1.9}
.book-kind{
  font-size:8px;letter-spacing:.15em;text-transform:uppercase;
  padding:4px 10px;margin-top:2px;
  background:var(--bg2);border:1px solid var(--faint);
  color:var(--muted);white-space:nowrap;height:fit-content;
}
.book-kind.paper{color:var(--future);border-color:var(--future);background:none}

/* â”€â”€ PHOTOS â”€â”€ */
.photos-intro{color:var(--muted);font-size:12px;margin-bottom:28px;line-height:2}
.photos-grid{
  display:grid;grid-template-columns:repeat(3,1fr);
  gap:3px;
}
.photo-slot{
  aspect-ratio:1;background:var(--bg2);
  border:1px solid var(--faint);
  display:flex;align-items:center;justify-content:center;
  position:relative;overflow:hidden;cursor:pointer;
  transition:border-color .2s;
}
.photo-slot:hover{border-color:var(--accent2)}
.photo-slot img{
  width:100%;height:100%;object-fit:cover;
  display:none;
}
.photo-slot.filled img{display:block}
.photo-slot.filled .ph-empty{display:none}
.ph-empty{text-align:center;color:var(--muted);pointer-events:none}
.ph-empty .plus{font-size:20px;display:block;margin-bottom:6px;color:var(--faint)}
.ph-empty span{font-size:9px;letter-spacing:.12em;text-transform:uppercase}
.ph-cap{
  position:absolute;bottom:0;left:0;right:0;
  background:rgba(28,26,23,.75);color:#fff;
  font-size:10px;padding:7px 10px;
  transform:translateY(100%);transition:transform .22s;
}
.photo-slot:hover .ph-cap{transform:none}
.ph-del{
  position:absolute;top:6px;right:6px;
  background:rgba(28,26,23,.6);color:#fff;
  border:none;width:22px;height:22px;
  font-size:12px;cursor:pointer;
  display:none;align-items:center;justify-content:center;
}
.edit-mode .ph-del{display:flex}

/* â”€â”€ MODAL â”€â”€ */
.overlay{
  display:none;position:fixed;inset:0;
  background:rgba(28,26,23,.55);z-index:200;
  align-items:center;justify-content:center;
  padding:24px;
}
.overlay.open{display:flex}
.modal{
  background:var(--bg);border:1px solid var(--faint);
  padding:40px;width:520px;max-width:100%;
  max-height:90vh;overflow-y:auto;
  animation:slideUp .25s both;
}
@keyframes slideUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:none}}
.modal h3{
  font-family:'Cormorant Garamond',serif;
  font-size:24px;font-weight:300;margin-bottom:28px;
}
.field{margin-bottom:18px}
.field label{
  display:block;font-size:9px;letter-spacing:.2em;
  text-transform:uppercase;color:var(--muted);margin-bottom:6px;
}
.field input,.field textarea,.field select{
  width:100%;background:none;border:1px solid var(--faint);
  padding:10px 14px;font-family:'DM Mono',monospace;
  font-size:12px;color:var(--ink);outline:none;
  transition:border-color .2s;appearance:none;
}
.field input:focus,.field textarea:focus,.field select:focus{border-color:var(--accent)}
.field textarea{min-height:80px;resize:vertical;line-height:1.8}
.field-row{display:grid;grid-template-columns:1fr 1fr;gap:16px}
.modal-actions{display:flex;gap:12px;margin-top:28px;justify-content:flex-end}
.btn{
  padding:10px 24px;font-family:'DM Mono',monospace;
  font-size:10px;letter-spacing:.12em;text-transform:uppercase;
  cursor:pointer;border:1px solid var(--ink);background:none;
  color:var(--ink);transition:all .2s;
}
.btn:hover{background:var(--ink);color:var(--bg)}
.btn-ghost{border-color:var(--faint);color:var(--muted)}
.btn-ghost:hover{background:var(--faint);color:var(--ink)}
.checkbox-row{display:flex;align-items:center;gap:10px;margin-top:4px}
.checkbox-row input[type=checkbox]{width:auto;border:none}

/* â”€â”€ EMPTY STATE â”€â”€ */
.empty-state{
  text-align:center;padding:48px 24px;
  color:var(--muted);font-size:12px;
  border:1px dashed var(--faint);
}
.empty-state .es-icon{font-size:28px;margin-bottom:12px;opacity:.4}

/* â”€â”€ ANIMATIONS â”€â”€ */
@keyframes rise{from{opacity:0;transform:translateY(18px)}to{opacity:1;transform:none}}
.reveal{opacity:0;transform:translateY(14px);transition:opacity .6s,transform .6s}
.reveal.in{opacity:1;transform:none}

/* â”€â”€ EDIT MODE INDICATOR â”€â”€ */
.edit-banner{
  display:none;position:fixed;bottom:0;left:0;right:0;z-index:99;
  background:var(--accent);color:#fff;
  text-align:center;font-size:10px;letter-spacing:.18em;
  text-transform:uppercase;padding:8px;
}
.edit-mode .edit-banner{display:block}
.edit-mode section{outline:1px dashed transparent;transition:outline .2s}
.edit-mode section:hover{outline-color:var(--faint)}

/* â”€â”€ PROFILE SECTION â”€â”€ */
.profile-grid{display:grid;grid-template-columns:140px 1fr;gap:40px;align-items:start}
.profile-img-wrap{
  aspect-ratio:1;background:var(--bg2);border:1px solid var(--faint);
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;position:relative;overflow:hidden;
}
.profile-img-wrap img{width:100%;height:100%;object-fit:cover;display:none}
.profile-img-wrap.filled img{display:block}
.profile-img-wrap.filled .profile-ph{display:none}
.profile-ph{color:var(--muted);font-size:10px;text-align:center;letter-spacing:.1em}
.profile-info{}
.profile-name{
  font-family:'Cormorant Garamond',serif;
  font-size:36px;font-weight:300;margin-bottom:6px;
}
.profile-name em{font-style:italic;color:var(--accent)}
.profile-tagline{color:var(--muted);font-size:12px;line-height:2;margin-bottom:16px}
.profile-chips{display:flex;flex-wrap:wrap;gap:8px}

/* RESPONSIVE */
@media(max-width:640px){
  nav{padding:18px 24px}
  .nav-links{gap:20px}
  .wrap{padding:0 24px}
  .skills-grid{grid-template-columns:1fr}
  .profile-grid{grid-template-columns:1fr;gap:24px}
  .tl-item{grid-template-columns:1fr;gap:4px}
  .book-item{grid-template-columns:36px 1fr;gap:0 14px}
  .book-kind{display:none}
}
</style>
</head>
<body>

<!-- EDIT BANNER -->
<div class="edit-banner">âœ ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ â€” å„é …ç›®ã® âœ ãƒœã‚¿ãƒ³ã§ç·¨é›† Â· ï¼‹ ãƒœã‚¿ãƒ³ã§è¿½åŠ </div>

<!-- NAV -->
<nav id="mainnav">
  <span class="nav-logo" onclick="scrollTo({top:0,behavior:'smooth'})">My <em>Universe</em></span>
  <div class="nav-links">
    <a href="#about">About</a>
    <a href="#career">çµŒæ­´</a>
    <a href="#projects">Projects</a>
    <a href="#future">Future</a>
    <a href="#books">Books</a>
    <a href="#photos">Photos</a>
    <button class="nav-edit-toggle" id="editToggle" onclick="toggleEditMode()">âœ ç·¨é›†</button>
  </div>
</nav>

<div class="wrap">

  <!-- ABOUT / PROFILE -->
  <section id="about">
    <div class="sh">About</div>
    <div class="profile-grid">
      <div class="profile-img-wrap" id="profileImgWrap" onclick="triggerProfileImg()">
        <img id="profileImg" src="" alt="">
        <div class="profile-ph">
          <div style="font-size:28px;margin-bottom:6px;opacity:.3">â—¯</div>
          <span>å†™çœŸã‚’è¿½åŠ </span>
        </div>
      </div>
      <div class="profile-info">
        <div class="profile-name" id="profileName">Your <em>Name</em></div>
        <div class="profile-tagline" id="profileTagline">ã“ã“ã«è‡ªå·±ç´¹ä»‹ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚<br>ç ”ç©¶ãƒ†ãƒ¼ãƒã€é–¢å¿ƒäº‹ã€å¤§åˆ‡ã«ã—ã¦ã„ã‚‹ã“ã¨ãªã©ã€‚</div>
        <div class="profile-chips" id="profileChips"></div>
        <div style="margin-top:20px;display:none" id="profileEditBtn">
          <button class="add-btn" style="width:auto;padding:8px 18px;display:inline-flex" onclick="openProfileModal()">âœ ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’ç·¨é›†</button>
        </div>
      </div>
    </div>
  </section>

  <!-- CAREER -->
  <section id="career">
    <div class="sh">çµŒæ­´ / Career & Skills</div>
    <div class="timeline" id="timeline"></div>
    <button class="add-btn" onclick="openModal('career')">ï¼‹ çµŒæ­´ãƒ»è³‡æ ¼ã‚’è¿½åŠ </button>
  </section>

  <!-- PROJECTS -->
  <section id="projects">
    <div class="sh">Projects / Portfolio</div>
    <div class="projects-list" id="projectsList"></div>
    <button class="add-btn" onclick="openModal('project')">ï¼‹ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿½åŠ </button>
  </section>

  <!-- FUTURE -->
  <section id="future">
    <div class="sh">Future / æœªæ¥ã®ç›®æ¨™ãƒ»è¨ˆç”»</div>
    <div class="future-list" id="futureList"></div>
    <button class="add-btn" onclick="openModal('future')">ï¼‹ ç›®æ¨™ãƒ»è¨ˆç”»ã‚’è¿½åŠ </button>
  </section>

  <!-- BOOKS & PAPERS -->
  <section id="books">
    <div class="sh">Books & Papers / èª­æ›¸ãƒ»è«–æ–‡ãƒªã‚¹ãƒˆ</div>
    <div class="books-list" id="booksList"></div>
    <button class="add-btn" onclick="openModal('book')">ï¼‹ æœ¬ãƒ»è«–æ–‡ã‚’è¿½åŠ </button>
  </section>

  <!-- PHOTOS -->
  <section id="photos">
    <div class="sh">Photos / æ—¥ã€…ã®ã‹ã‘ã‚‰</div>
    <p class="photos-intro">å†™çœŸã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã€‚ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³ã‚‚è¿½åŠ ã§ãã¾ã™ã€‚<br>ç”»åƒã¯ãƒ–ãƒ©ã‚¦ã‚¶ã«ä¿å­˜ã•ã‚Œã€å¤–éƒ¨ã«ã¯é€ä¿¡ã•ã‚Œã¾ã›ã‚“ã€‚</p>
    <div class="photos-grid" id="photosGrid"></div>
    <button class="add-btn" onclick="addPhotoSlot()">ï¼‹ å†™çœŸã‚¹ãƒ­ãƒƒãƒˆã‚’è¿½åŠ </button>
  </section>

</div><!-- /wrap -->

<div style="text-align:center;padding:48px 24px;color:var(--muted);font-size:10px;letter-spacing:.1em;border-top:1px solid var(--faint)">
  My Private Universe â€” GitHub Pages
</div>

<!-- OVERLAY / MODAL -->
<div class="overlay" id="overlay" onclick="overlayClick(event)">
  <div class="modal" id="modal"></div>
</div>

<input type="file" id="photoInput" accept="image/*" style="display:none">
<input type="file" id="profileImgInput" accept="image/*" style="display:none">

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   STATE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let state = {
  profile: {
    name: 'Your Name',
    nameItalic: '',
    tagline: 'ã“ã“ã«è‡ªå·±ç´¹ä»‹ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚\nç ”ç©¶ãƒ†ãƒ¼ãƒã€é–¢å¿ƒäº‹ã€å¤§åˆ‡ã«ã—ã¦ã„ã‚‹ã“ã¨ãªã©ã€‚',
    chips: [],
    img: ''
  },
  career: [],
  projects: [],
  future: [],
  books: [],
  photos: []
};

let editMode = false;
let editingId = null;
let editingSection = null;
let photoSlotTarget = null;

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   STORAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function save() {
  try { localStorage.setItem('myuniverse_state', JSON.stringify(state)); } catch(e){}
}
function load() {
  try {
    const s = localStorage.getItem('myuniverse_state');
    if (s) state = JSON.parse(s);
  } catch(e){}
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   EDIT MODE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function toggleEditMode() {
  editMode = !editMode;
  document.body.classList.toggle('edit-mode', editMode);
  document.getElementById('editToggle').textContent = editMode ? 'âœ“ å®Œäº†' : 'âœ ç·¨é›†';
  document.getElementById('editToggle').classList.toggle('active', editMode);
  document.getElementById('profileEditBtn').style.display = editMode ? 'block' : 'none';
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RENDER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function uid() { return Date.now().toString(36) + Math.random().toString(36).slice(2); }

function renderAll() {
  renderProfile();
  renderCareer();
  renderProjects();
  renderFuture();
  renderBooks();
  renderPhotos();
}

/* PROFILE */
function renderProfile() {
  const p = state.profile;
  const nameEl = document.getElementById('profileName');
  nameEl.innerHTML = p.nameItalic
    ? `${p.name} <em>${p.nameItalic}</em>`
    : p.name;
  document.getElementById('profileTagline').innerHTML = p.tagline.replace(/\n/g,'<br>');
  const chipsEl = document.getElementById('profileChips');
  chipsEl.innerHTML = p.chips.map(c=>`<span class="chip">${c}</span>`).join('');
  const imgEl = document.getElementById('profileImg');
  const wrap = document.getElementById('profileImgWrap');
  if (p.img) {
    imgEl.src = p.img;
    wrap.classList.add('filled');
  } else {
    imgEl.src = '';
    wrap.classList.remove('filled');
  }
}

/* CAREER */
function renderCareer() {
  const el = document.getElementById('timeline');
  if (!state.career.length) {
    el.innerHTML = `<div class="empty-state"><div class="es-icon">â—·</div>çµŒæ­´ãƒ»è³‡æ ¼ã‚’ã¾ã è¿½åŠ ã—ã¦ã„ã¾ã›ã‚“<br>ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã§ã€Œï¼‹ è¿½åŠ ã€ã‚’ã‚¯ãƒªãƒƒã‚¯</div>`;
    return;
  }
  el.innerHTML = state.career.map(item => `
    <div class="tl-item ${item.future?'future':''} reveal">
      <div class="tl-year">${item.year||'â€”'}</div>
      <div class="tl-body">
        <div class="tl-title">${item.title}${item.future?'<span class="future-badge">äºˆå®š</span>':''}</div>
        ${item.org?`<div class="tl-org">${item.org}</div>`:''}
        ${item.desc?`<div class="tl-desc">${item.desc.replace(/\n/g,'<br>')}</div>`:''}
      </div>
      <div class="item-actions">
        <button class="ia-btn" onclick="editItem('career','${item.id}')">âœ</button>
        <button class="ia-btn del" onclick="deleteItem('career','${item.id}')">âœ•</button>
      </div>
    </div>
  `).join('');
  observeReveal();
}

/* PROJECTS */
function renderProjects() {
  const el = document.getElementById('projectsList');
  if (!state.projects.length) {
    el.innerHTML = `<div class="empty-state"><div class="es-icon">â—ˆ</div>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ã¾ã è¿½åŠ ã—ã¦ã„ã¾ã›ã‚“</div>`;
    return;
  }
  el.innerHTML = state.projects.map(item => `
    <div class="proj-item reveal">
      <div>
        <div class="proj-title">${item.title}</div>
        ${item.desc?`<div class="proj-desc">${item.desc.replace(/\n/g,'<br>')}</div>`:''}
        <div class="proj-tags">${(item.tags||[]).map(t=>`<span class="ptag">${t}</span>`).join('')}</div>
      </div>
      <div style="display:flex;flex-direction:column;align-items:flex-end;gap:8px">
        ${item.link?`<a class="proj-link" href="${item.link}" target="_blank">â†’ è¦‹ã‚‹</a>`:''}
        <div class="item-actions" style="position:static;display:none">
          <button class="ia-btn" onclick="editItem('project','${item.id}')">âœ</button>
          <button class="ia-btn del" onclick="deleteItem('project','${item.id}')">âœ•</button>
        </div>
      </div>
    </div>
  `).join('');
  if(editMode) document.querySelectorAll('.proj-item .item-actions').forEach(el=>el.style.display='flex');
  observeReveal();
}

/* FUTURE */
function renderFuture() {
  const el = document.getElementById('futureList');
  if (!state.future.length) {
    el.innerHTML = `<div class="empty-state"><div class="es-icon">â—</div>æœªæ¥ã®ç›®æ¨™ã‚’ã¾ã è¿½åŠ ã—ã¦ã„ã¾ã›ã‚“</div>`;
    return;
  }
  el.innerHTML = state.future.map((item,i) => `
    <div class="fut-item reveal">
      <div class="fut-num">${String(i+1).padStart(2,'0')}</div>
      <div class="fut-text">
        <div class="fut-title">${item.title}</div>
        ${item.desc?`<div class="fut-desc">${item.desc.replace(/\n/g,'<br>')}</div>`:''}
        ${item.horizon?`<div class="fut-horizon">${item.horizon}</div>`:''}
      </div>
      <div class="item-actions">
        <button class="ia-btn" onclick="editItem('future','${item.id}')">âœ</button>
        <button class="ia-btn del" onclick="deleteItem('future','${item.id}')">âœ•</button>
      </div>
    </div>
  `).join('');
  observeReveal();
}

/* BOOKS */
function renderBooks() {
  const el = document.getElementById('booksList');
  if (!state.books.length) {
    el.innerHTML = `<div class="empty-state"><div class="es-icon">â—»</div>æœ¬ãƒ»è«–æ–‡ã‚’ã¾ã è¿½åŠ ã—ã¦ã„ã¾ã›ã‚“</div>`;
    return;
  }
  el.innerHTML = state.books.map((item,i) => `
    <div class="book-item reveal">
      <div class="book-n">${String(i+1).padStart(2,'0')}</div>
      <div>
        <div class="book-title">${item.title}</div>
        ${item.author?`<div class="book-author">${item.author}</div>`:''}
        ${item.note?`<div class="book-note">${item.note.replace(/\n/g,'<br>')}</div>`:''}
      </div>
      <div style="display:flex;flex-direction:column;align-items:flex-end;gap:8px">
        <div class="book-kind ${item.kind==='è«–æ–‡'?'paper':''}">${item.kind||'æ›¸ç±'}</div>
        <div class="item-actions" style="position:static;display:none">
          <button class="ia-btn" onclick="editItem('book','${item.id}')">âœ</button>
          <button class="ia-btn del" onclick="deleteItem('book','${item.id}')">âœ•</button>
        </div>
      </div>
    </div>
  `).join('');
  if(editMode) document.querySelectorAll('.book-item .item-actions').forEach(el=>el.style.display='flex');
  observeReveal();
}

/* PHOTOS */
function renderPhotos() {
  const grid = document.getElementById('photosGrid');
  grid.innerHTML = state.photos.map((p,i) => `
    <div class="photo-slot ${p.img?'filled':''}" data-idx="${i}" onclick="handlePhotoClick(${i})">
      <img src="${p.img||''}" alt="">
      <div class="ph-empty">
        <span class="plus">ï¼‹</span>
        <span>å†™çœŸã‚’è¿½åŠ </span>
      </div>
      ${p.cap?`<div class="ph-cap">${p.cap}</div>`:''}
      <button class="ph-del" onclick="deletePhoto(event,${i})">âœ•</button>
    </div>
  `).join('');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCROLL REVEAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function observeReveal() {
  const obs = new IntersectionObserver(entries=>{
    entries.forEach(e=>{ if(e.isIntersecting) e.target.classList.add('in'); });
  },{threshold:.1});
  document.querySelectorAll('.reveal:not(.in)').forEach(el=>obs.observe(el));
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MODAL SYSTEM
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function openModal(section, id) {
  editingSection = section;
  editingId = id || null;
  const existing = id ? state[section === 'career' ? 'career'
    : section === 'project' ? 'projects'
    : section === 'future' ? 'future'
    : 'books'].find(x=>x.id===id) : null;

  let html = '';

  if (section === 'career') {
    html = `
      <h3>${id ? 'çµŒæ­´ã‚’ç·¨é›†' : 'çµŒæ­´ãƒ»è³‡æ ¼ã‚’è¿½åŠ '}</h3>
      <div class="field-row">
        <div class="field"><label>æœŸé–“ãƒ»å¹´</label><input id="f_year" value="${existing?.year||''}" placeholder="2019â€“2023"></div>
        <div class="field"><label>ç¨®åˆ¥</label><select id="f_type">
          <option value="education" ${existing?.type==='education'?'selected':''}>ğŸ“ å­¦æ­´</option>
          <option value="work" ${existing?.type==='work'?'selected':''}>ğŸ’¼ è·æ­´</option>
          <option value="cert" ${existing?.type==='cert'?'selected':''}>ğŸ“œ è³‡æ ¼</option>
          <option value="other" ${existing?.type==='other'?'selected':''}>ãã®ä»–</option>
        </select></div>
      </div>
      <div class="field"><label>ã‚¿ã‚¤ãƒˆãƒ«</label><input id="f_title" value="${existing?.title||''}" placeholder="å¤§å­¦åãƒ»ä¼šç¤¾åãƒ»è³‡æ ¼å"></div>
      <div class="field"><label>æ©Ÿé–¢ãƒ»çµ„ç¹”</label><input id="f_org" value="${existing?.org||''}" placeholder="å­¦éƒ¨ãƒ»éƒ¨ç½²ãªã©"></div>
      <div class="field"><label>è©³ç´°</label><textarea id="f_desc" placeholder="å­¦ã‚“ã ã“ã¨ãƒ»æ¥­å‹™å†…å®¹ãªã©">${existing?.desc||''}</textarea></div>
      <div class="field"><div class="checkbox-row"><input type="checkbox" id="f_future" ${existing?.future?'checked':''}><label for="f_future" style="text-transform:none;font-size:12px;letter-spacing:0;color:var(--future)">ã€Œã“ã‚Œã‹ã‚‰ã€ã®äºˆå®šã¨ã—ã¦è¡¨ç¤ºã™ã‚‹</label></div></div>
      <div class="modal-actions">
        <button class="btn btn-ghost" onclick="closeModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button class="btn" onclick="saveCareer()">ä¿å­˜</button>
      </div>`;
  } else if (section === 'project') {
    html = `
      <h3>${id ? 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ç·¨é›†' : 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿½åŠ '}</h3>
      <div class="field"><label>ã‚¿ã‚¤ãƒˆãƒ«</label><input id="f_title" value="${existing?.title||''}" placeholder="ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå"></div>
      <div class="field"><label>èª¬æ˜</label><textarea id="f_desc" placeholder="ä½•ã‚’ã—ãŸã‹ã€æˆæœãªã©">${existing?.desc||''}</textarea></div>
      <div class="field"><label>æŠ€è¡“ãƒ»ã‚¿ã‚°ï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰</label><input id="f_tags" value="${(existing?.tags||[]).join(', ')}" placeholder="React, Python, Stata ..."></div>
      <div class="field"><label>URLï¼ˆä»»æ„ï¼‰</label><input id="f_link" value="${existing?.link||''}" placeholder="https://github.com/..."></div>
      <div class="modal-actions">
        <button class="btn btn-ghost" onclick="closeModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button class="btn" onclick="saveProject()">ä¿å­˜</button>
      </div>`;
  } else if (section === 'future') {
    html = `
      <h3>${id ? 'ç›®æ¨™ã‚’ç·¨é›†' : 'ç›®æ¨™ãƒ»è¨ˆç”»ã‚’è¿½åŠ '}</h3>
      <div class="field"><label>ç›®æ¨™</label><input id="f_title" value="${existing?.title||''}" placeholder="é”æˆã—ãŸã„ã“ã¨"></div>
      <div class="field"><label>è©³ç´°ãƒ»ç†ç”±</label><textarea id="f_desc" placeholder="ãªãœç›®æŒ‡ã™ã®ã‹ã€å…·ä½“çš„ãªè¨ˆç”»ãªã©">${existing?.desc||''}</textarea></div>
      <div class="field"><label>æ™‚é–“è»¸</label><input id="f_horizon" value="${existing?.horizon||''}" placeholder="2026, 3å¹´ä»¥å†…, ç¶™ç¶šçš„..."></div>
      <div class="modal-actions">
        <button class="btn btn-ghost" onclick="closeModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button class="btn" onclick="saveFuture()">ä¿å­˜</button>
      </div>`;
  } else if (section === 'book') {
    html = `
      <h3>${id ? 'æ›¸ç±ãƒ»è«–æ–‡ã‚’ç·¨é›†' : 'æ›¸ç±ãƒ»è«–æ–‡ã‚’è¿½åŠ '}</h3>
      <div class="field-row">
        <div class="field"><label>ç¨®åˆ¥</label><select id="f_kind">
          <option value="æ›¸ç±" ${existing?.kind==='æ›¸ç±'||!existing?'selected':''}>ğŸ“š æ›¸ç±</option>
          <option value="è«–æ–‡" ${existing?.kind==='è«–æ–‡'?'selected':''}>ğŸ“„ è«–æ–‡</option>
          <option value="è¨˜äº‹" ${existing?.kind==='è¨˜äº‹'?'selected':''}>ğŸ“° è¨˜äº‹</option>
          <option value="ãã®ä»–" ${existing?.kind==='ãã®ä»–'?'selected':''}>ãã®ä»–</option>
        </select></div>
        <div class="field"><label>èª­äº†çŠ¶æ³</label><select id="f_status">
          <option value="èª­äº†" ${existing?.status==='èª­äº†'||!existing?'selected':''}>âœ“ èª­äº†</option>
          <option value="èª­ä¸­" ${existing?.status==='èª­ä¸­'?'selected':''}>â—‘ èª­ä¸­</option>
          <option value="ç©èª­" ${existing?.status==='ç©èª­'?'selected':''}>â—‹ ç©èª­</option>
        </select></div>
      </div>
      <div class="field"><label>ã‚¿ã‚¤ãƒˆãƒ«</label><input id="f_title" value="${existing?.title||''}" placeholder="æ›¸ç±ãƒ»è«–æ–‡ã‚¿ã‚¤ãƒˆãƒ«"></div>
      <div class="field"><label>è‘—è€… / Author</label><input id="f_author" value="${existing?.author||''}" placeholder="è‘—è€…åã€å‡ºç‰ˆå¹´ãªã©"></div>
      <div class="field"><label>ãƒ¡ãƒ¢ãƒ»æ„Ÿæƒ³</label><textarea id="f_note" placeholder="å­¦ã‚“ã ã“ã¨ã€å°è±¡ã«æ®‹ã£ãŸã“ã¨">${existing?.note||''}</textarea></div>
      <div class="modal-actions">
        <button class="btn btn-ghost" onclick="closeModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button class="btn" onclick="saveBook()">ä¿å­˜</button>
      </div>`;
  }

  document.getElementById('modal').innerHTML = html;
  document.getElementById('overlay').classList.add('open');
  setTimeout(()=>{ const fi = document.getElementById('f_title')||document.getElementById('f_year'); if(fi)fi.focus(); },50);
}

function openProfileModal() {
  const p = state.profile;
  document.getElementById('modal').innerHTML = `
    <h3>ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’ç·¨é›†</h3>
    <div class="field-row">
      <div class="field"><label>åå‰</label><input id="f_name" value="${p.name}" placeholder="Your Name"></div>
      <div class="field"><label>åå‰ï¼ˆã‚¤ã‚¿ãƒªãƒƒã‚¯éƒ¨åˆ†ï¼‰</label><input id="f_nameitalic" value="${p.nameItalic||''}" placeholder="Family name ãªã©"></div>
    </div>
    <div class="field"><label>è‡ªå·±ç´¹ä»‹</label><textarea id="f_tagline" placeholder="ç ”ç©¶ãƒ†ãƒ¼ãƒãƒ»é–¢å¿ƒäº‹ãªã©">${p.tagline}</textarea></div>
    <div class="field"><label>ã‚¿ã‚°ï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰</label><input id="f_chips" value="${p.chips.join(', ')}" placeholder="Sociology, NUS, Tokyo..."></div>
    <div class="modal-actions">
      <button class="btn btn-ghost" onclick="closeModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
      <button class="btn" onclick="saveProfile()">ä¿å­˜</button>
    </div>`;
  document.getElementById('overlay').classList.add('open');
}

function closeModal() { document.getElementById('overlay').classList.remove('open'); }
function overlayClick(e) { if(e.target===document.getElementById('overlay')) closeModal(); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SAVE HANDLERS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function saveProfile() {
  state.profile.name = document.getElementById('f_name').value.trim() || 'Your Name';
  state.profile.nameItalic = document.getElementById('f_nameitalic').value.trim();
  state.profile.tagline = document.getElementById('f_tagline').value.trim();
  state.profile.chips = document.getElementById('f_chips').value.split(',').map(s=>s.trim()).filter(Boolean);
  save(); renderProfile(); closeModal();
}

function saveCareer() {
  const item = {
    id: editingId || uid(),
    year: document.getElementById('f_year').value.trim(),
    type: document.getElementById('f_type').value,
    title: document.getElementById('f_title').value.trim(),
    org: document.getElementById('f_org').value.trim(),
    desc: document.getElementById('f_desc').value.trim(),
    future: document.getElementById('f_future').checked
  };
  if (!item.title) return;
  if (editingId) {
    const idx = state.career.findIndex(x=>x.id===editingId);
    if(idx>-1) state.career[idx]=item;
  } else {
    state.career.push(item);
  }
  save(); renderCareer(); closeModal();
}

function saveProject() {
  const item = {
    id: editingId || uid(),
    title: document.getElementById('f_title').value.trim(),
    desc: document.getElementById('f_desc').value.trim(),
    tags: document.getElementById('f_tags').value.split(',').map(s=>s.trim()).filter(Boolean),
    link: document.getElementById('f_link').value.trim()
  };
  if (!item.title) return;
  if (editingId) {
    const idx = state.projects.findIndex(x=>x.id===editingId);
    if(idx>-1) state.projects[idx]=item;
  } else {
    state.projects.push(item);
  }
  save(); renderProjects(); closeModal();
}

function saveFuture() {
  const item = {
    id: editingId || uid(),
    title: document.getElementById('f_title').value.trim(),
    desc: document.getElementById('f_desc').value.trim(),
    horizon: document.getElementById('f_horizon').value.trim()
  };
  if (!item.title) return;
  if (editingId) {
    const idx = state.future.findIndex(x=>x.id===editingId);
    if(idx>-1) state.future[idx]=item;
  } else {
    state.future.push(item);
  }
  save(); renderFuture(); closeModal();
}

function saveBook() {
  const item = {
    id: editingId || uid(),
    kind: document.getElementById('f_kind').value,
    status: document.getElementById('f_status').value,
    title: document.getElementById('f_title').value.trim(),
    author: document.getElementById('f_author').value.trim(),
    note: document.getElementById('f_note').value.trim()
  };
  if (!item.title) return;
  if (editingId) {
    const idx = state.books.findIndex(x=>x.id===editingId);
    if(idx>-1) state.books[idx]=item;
  } else {
    state.books.push(item);
  }
  save(); renderBooks(); closeModal();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   EDIT / DELETE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function editItem(section, id) {
  const map = {career:'career',project:'projects',future:'future',book:'books'};
  // find which collection
  if (section==='career') openModal('career',id);
  else if (section==='project') openModal('project',id);
  else if (section==='future') openModal('future',id);
  else if (section==='book') openModal('book',id);
}

function deleteItem(section, id) {
  if (!confirm('å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) return;
  const map = {career:'career',project:'projects',future:'future',book:'books'};
  const key = map[section];
  state[key] = state[key].filter(x=>x.id!==id);
  save();
  if(section==='career') renderCareer();
  else if(section==='project') renderProjects();
  else if(section==='future') renderFuture();
  else if(section==='book') renderBooks();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PHOTOS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function addPhotoSlot() {
  state.photos.push({id:uid(),img:'',cap:''});
  save(); renderPhotos();
}

function handlePhotoClick(idx) {
  const p = state.photos[idx];
  if (!p.img) {
    photoSlotTarget = idx;
    document.getElementById('photoInput').click();
  } else if (editMode) {
    // edit caption
    const cap = prompt('ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³ã‚’å…¥åŠ›:', p.cap||'');
    if (cap !== null) {
      state.photos[idx].cap = cap;
      save(); renderPhotos();
    }
  }
}

function deletePhoto(e, idx) {
  e.stopPropagation();
  if (!confirm('å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) return;
  state.photos.splice(idx,1);
  save(); renderPhotos();
}

document.getElementById('photoInput').addEventListener('change', function(e) {
  const file = e.target.files[0];
  if (!file || photoSlotTarget === null) return;
  const reader = new FileReader();
  reader.onload = function(ev) {
    state.photos[photoSlotTarget].img = ev.target.result;
    save(); renderPhotos();
    photoSlotTarget = null;
  };
  reader.readAsDataURL(file);
  this.value = '';
});

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PROFILE IMAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function triggerProfileImg() {
  if (!editMode) return;
  document.getElementById('profileImgInput').click();
}
document.getElementById('profileImgInput').addEventListener('change', function(e) {
  const file = e.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = function(ev) {
    state.profile.img = ev.target.result;
    save(); renderProfile();
  };
  reader.readAsDataURL(file);
  this.value = '';
});

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCROLL NAV
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
window.addEventListener('scroll', ()=>{
  document.getElementById('mainnav').classList.toggle('scrolled', window.scrollY > 40);
});

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   KEYBOARD
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
document.addEventListener('keydown', e=>{
  if (e.key==='Escape') closeModal();
});

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   INIT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
load();
renderAll();
observeReveal();
</script>
</body>
</html>
